[["data-transformation.html", "Chapter 3 Data transformation 3.1 ON PROCESS", " Chapter 3 Data transformation 3.1 ON PROCESS Right now this is a test for code can return output when post it library(readxl) library(tidyverse) library(ggplot2) library(stringr) library(redav) library(mi) library(ggpubr) projdata &lt;- read_excel(&quot;Census_All-Places-of-Origin_OD21.xlsx&quot;, col_types = c(&quot;numeric&quot;, &quot;text&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;), na = &quot;-&quot;, col_names = T) names(projdata)[1] &lt;- &quot;Code of Origin&quot; projdata &lt;- projdata %&gt;% select(`Place of Origin`,`Code of Origin`, `1949/50`:`2020/21`) knitr::kable( head(projdata[, 1:8], 6), booktabs = TRUE, caption = &#39;A table of the first 6 rows of our final project data.&#39; ) Table 3.1: A table of the first 6 rows of our final project data. Place of Origin Code of Origin 1949/50 1954/55 1959/60 1964/65 1969/70 1974/75 NA NA NA NA NA NA NA NA AFRICA, SUB-SAHARAN 1000 537 862 1346 5259 6064 16040 Africa, Sub-saharan, Unspecified NA 19 NA NA 9 17 30 NA NA NA NA NA NA NA NA East Africa 1100 37 99 457 1860 1731 3949 Burundi 1101 NA NA NA 6 6 5 # whole row are empty uselessRow &lt;- rowSums(is.na(projdata)) == ncol(projdata) numNARow &lt;- sum(uselessRow); numNARow ## [1] 30 # we need to delete them because they are using for separate different place # also remove notes/suggesstions projdata &lt;- projdata[!uselessRow,] %&gt;% filter(!grepl(&quot;:&quot;,`Place of Origin`)) knitr::kable( tail(projdata[, 1:8], 3), booktabs = TRUE, caption = &#39;A table of the last 3 rows to check no extra information.&#39; ) Table 3.2: A table of the last 3 rows to check no extra information. Place of Origin Code of Origin 1949/50 1954/55 1959/60 1964/65 1969/70 1974/75 Pacific Islands, Unspecified NA NA 15 38 145 327 1263 Stateless 9901 195 42 93 205 341 134 WORLD TOTAL NA 26433 34232 48486 82045 134959 154580 # first remove the grouped summary projdata.re.state &lt;- projdata %&gt;% filter(!grepl(&quot;[0-9][0-9]00&quot;, `Code of Origin`)) %&gt;% # remove part of state summary filter(!grepl(&quot;[A-Z]+$&quot;, `Place of Origin`)) %&gt;% # remover state summary mutate(Continents = case_when(substring(`Code of Origin`, 1, 1) == 1 ~ &quot;Africa&quot;, substring(`Code of Origin`, 1, 1) == 2 ~ &quot;Asia&quot;, substring(`Code of Origin`, 1, 1) == 3 ~ &quot;Europe&quot;, substring(`Code of Origin`, 1, 1) == 4 ~ &quot;Latin America &amp; Caribbean&quot;, substring(`Code of Origin`, 1, 1) == 5 ~ &quot;Middle East&quot;, substring(`Code of Origin`, 1, 1) == 6 ~ &quot;North America&quot;, substring(`Code of Origin`, 1, 1) == 7 ~ &quot;Oceania&quot;, `Place of Origin` == &quot;Stateless&quot; ~ &quot;Unknown State&quot; ) ) projdata.re.state[projdata.re.state$`Place of Origin` == &quot;Bermuda&quot;,]$Continents &lt;- &quot;Latin America &amp; Caribbean&quot; # deal with the former country and grouped unspecified # temp.data &lt;- projdata.re.state[is.na(projdata.re.state$`Code of Origin`),] temp.data &lt;- projdata.re.state %&gt;% filter(grepl(&quot;[0-9]999&quot;, `Code of Origin`) | is.na(`Code of Origin`)) # unspecified temp.data.unsp &lt;- temp.data %&gt;% filter(grepl(&quot;Unspecified&quot;,`Place of Origin`) ) %&gt;% mutate(Continents = case_when(grepl(&quot;Africa&quot;,`Place of Origin`) ~ &quot;Africa&quot;, grepl(&quot;Asia&quot;,`Place of Origin`) ~ &quot;Asia&quot;, grepl(&quot;Europe&quot;,`Place of Origin`) ~ &quot;Europe&quot;, grepl(&quot;Latin America &amp; Caribbean&quot;,`Place of Origin`) ~ &quot;Latin America &amp; Caribbean&quot;, grepl(&quot;South America&quot;,`Place of Origin`) ~ &quot;Latin America &amp; Caribbean&quot;, grepl(&quot;Caribbean&quot;,`Place of Origin`) ~ &quot;Latin America &amp; Caribbean&quot;, grepl(&quot;Mexico&quot;,`Place of Origin`) ~ &quot;Latin America &amp; Caribbean&quot;, grepl(&quot;Middle East&quot;,`Place of Origin`) ~ &quot;Middle East&quot;, grepl(&quot;North America&quot;,`Place of Origin`) ~ &quot;North America&quot;, grepl(&quot;Pacific&quot;,`Place of Origin`) ~ &quot;Oceania&quot; ) ) %&gt;% group_by(Continents) %&gt;% summarize(.,across(where(is.numeric), ~sum(.x, na.rm = T))) %&gt;% mutate(`Place of Origin` = paste(Continents, &quot;Unspecified&quot;, sep = &quot;, &quot;)) %&gt;% select(`Place of Origin`, `Code of Origin`, `1949/50`:`2020/21`, Continents) temp.data.fna &lt;- temp.data %&gt;% filter(!grepl(&quot;Unspecified&quot;,`Place of Origin`) ) %&gt;% mutate(Continents = case_when(grepl(&quot;Former&quot;,`Place of Origin`) ~ &quot;Europe&quot;, grepl(&quot;Serbia&quot;,`Place of Origin`) ~ &quot;Europe&quot;, grepl(&quot;Antilles&quot;,`Place of Origin`) ~ &quot;Latin America &amp; Caribbean&quot;, grepl(&quot;Sahara&quot;,`Place of Origin`) ~ &quot;Africa&quot; ) ) 3.1.1 Data after transfrom, read for use. Named: df ## this is data for later drawing plots in ## missing value, results, and inreactive part. df &lt;- projdata.re.state %&gt;% filter(!grepl(&quot;Unspecified&quot;,`Place of Origin`) ) %&gt;% rows_update(temp.data.fna, by = &quot;Place of Origin&quot;) %&gt;% rbind(., temp.data.unsp) knitr::kable( head(df[, 1:8], 6), booktabs = TRUE, caption = &#39;A table of the first 6 rows of data ready for use in the future analysis.&#39; ) Table 3.3: A table of the first 6 rows of data ready for use in the future analysis. Place of Origin Code of Origin 1949/50 1954/55 1959/60 1964/65 1969/70 1974/75 Burundi 1101 NA NA NA 6 6 5 Djibouti 1102 NA NA NA NA NA 1 Eritrea 1103 NA NA NA NA NA NA Ethiopia 1104 37 62 170 266 540 2050 Kenya 1105 NA 19 156 774 492 870 Rwanda 1106 NA NA NA 2 1 4 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
