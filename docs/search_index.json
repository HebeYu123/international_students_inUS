[["results.html", "Chapter 5 Results 5.1 What the number of international students and growth trend in 20 century and 21 century 5.2 question 2 5.3 question 3", " Chapter 5 Results library(ggplot2) library(ggpubr) 5.1 What the number of international students and growth trend in 20 century and 21 century 5.1.1 Total number of international students study in the U.S. in different century tidysum &lt;- df.tidy %&gt;% select(`Place of Origin`, Continents, Academic_year, student_numbers, century) %&gt;% group_by(Continents, century) %&gt;% summarize(.,across(where(is.numeric), ~sum(.x, na.rm = T)/1000000)) %&gt;% ungroup() %&gt;% mutate(Continents = replace(Continents, Continents == &quot;Latin America &amp; Caribbean&quot;, &quot;LA&amp;C&quot;)) %&gt;% mutate(Continents = replace(Continents, Continents == &quot;Middle East&quot;, &quot;ME&quot;)) %&gt;% mutate(Continents = replace(Continents, Continents == &quot;North America&quot;, &quot;NorA&quot;)) %&gt;% mutate(Continents = replace(Continents, Continents == &quot;Unknown State&quot;, &quot;Unkwn&quot;)) %&gt;% mutate(Continents = replace(Continents, Continents == &quot;Oceania&quot;, &quot;Ocean&quot;)) ggplot(tidysum, aes(x = Continents, y = student_numbers)) + geom_col(color = &quot;#142b73&quot;, fill = &quot;#153E7E&quot;) + facet_wrap(~century) + ggtitle(&quot;Total number of international students study in the U.S. in different century&quot;) + xlab(&quot;Continents&quot;) + ylab(&quot;Student number (Million)&quot;) + theme_bw() + labs(caption = &quot;(LA&amp;C: Latin America &amp; Caribbean, ME: Middle East, NorA: North America, Ocean: Oceania)&quot;) + theme(panel.grid.major.x = element_blank(), plot.caption = element_text(color = &quot;darkgrey&quot;, face = &quot;italic&quot;, size = 9, hjust = 0.5)) 5.1.2 trend of international students study in the U.S. in different century draw.totalnum &lt;- function(c){ tidytotal.num &lt;- df.tidy %&gt;% select(`Place of Origin`, Continents, Academic_year, student_numbers, century) %&gt;% filter(century == c) %&gt;% group_by(Continents, Academic_year, century) %&gt;% summarize(.,across(where(is.numeric), ~sum(.x, na.rm = T))/100000) %&gt;% ungroup() ggplot(tidytotal.num, aes(as.numeric(substr(Academic_year, 1,4)), student_numbers, col = Continents)) + geom_line(alpha = 0.5) + geom_point(alpha = 0.8) + xlab(&quot;&quot;)+ ylab(&quot;&quot;)+ ylim(0,9) + theme_bw() + theme(panel.grid.major.x = element_blank(), plot.caption = element_text(color = &quot;grey&quot;, face = &quot;italic&quot;, size = 9, hjust = 0.5)) + scale_color_brewer(palette=&quot;Dark2&quot;) } p20 &lt;- draw.totalnum(&quot;20th century&quot;) p21 &lt;- draw.totalnum(&quot;21th century&quot;) pt &lt;- ggarrange(p20, p21, ncol=2, nrow=1, common.legend = TRUE, legend=&quot;top&quot;) annotate_figure(pt, top = text_grob(&quot;Total number of international students study in the U.S. in different century&quot;, face = &quot;bold&quot;, size = 12), left = &quot;Student number (Million)&quot;, bottom = &quot;Year in 20th centry (left) and 21th centry (right)&quot;) 5.1.3 The largest increase in the total number of students per country/region in two centuries on the continent tidysum.asia &lt;- df.tidy %&gt;% select(`Place of Origin`, Continents, Academic_year, student_numbers, century) %&gt;% filter(Continents == &quot;Asia&quot;) %&gt;% group_by(`Place of Origin`, century) %&gt;% summarize(.,across(where(is.numeric), ~sum(.x, na.rm = T)/1000000)) %&gt;% ungroup() top5.asia &lt;- tidysum.asia %&gt;% group_by(`Place of Origin`) %&gt;% summarise(total_num = sum(student_numbers)) %&gt;% slice_max(total_num, n = 16) %&gt;% select(`Place of Origin`) p.top16 &lt;- tidysum.asia %&gt;% filter(`Place of Origin` %in% top5.asia$`Place of Origin`) %&gt;% ggplot(aes(x = student_numbers, y = fct_reorder2(`Place of Origin`, century == &quot;21th century&quot;, student_numbers, .desc = FALSE), color = century)) + geom_point(size = 2) + labs(title = &quot;Top 16 countries/region with students&quot;) + xlab(&quot;&quot;)+ ylab(&quot;&quot;)+ xlim(0, 4.5)+ theme_linedraw() + scale_color_manual(values = c(&quot;#C3D7A4&quot;, &quot;#153E7E&quot;)) p.other &lt;- tidysum.asia %&gt;% filter(!(`Place of Origin` %in% top5.asia$`Place of Origin`)) %&gt;% ggplot(aes(x = student_numbers, y = fct_reorder2(`Place of Origin`, century == &quot;21th century&quot;, student_numbers, .desc = FALSE), color = century)) + geom_point(size = 2) + labs(title = &quot;Countries/region with a few students&quot;) + xlab(&quot;Student numbers (Million)&quot;)+ ylab(&quot;&quot;)+ xlim(0, 0.045)+ theme_linedraw() + scale_color_manual(values = c(&quot;#C3D7A4&quot;, &quot;#153E7E&quot;)) pt2 &lt;- ggarrange(p.top16, p.other, ncol=1, nrow=2, common.legend = TRUE, legend=&quot;top&quot;, align = &quot;v&quot;) annotate_figure(pt2, top = text_grob(&quot;Number of Asian students study in US&quot;, face = &quot;bold&quot;, size = 12)) 5.2 question 2 5.3 question 3 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
