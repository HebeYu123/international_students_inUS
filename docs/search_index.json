[["missing-values.html", "Chapter 4 Missing values 4.1 still working on comments", " Chapter 4 Missing values library(redav) 4.1 still working on comments # find which continents do not have na values df.nabygroup &lt;- df %&gt;% group_by(Continents) %&gt;% summarize_all(.funs = funs(&#39;NA&#39; = sum(is.na(.)))) non.na.index &lt;- which(rowSums(df.nabygroup[2:ncol(df.nabygroup)]) == 0) Continents.non.na &lt;- df.nabygroup[non.na.index,1] knitr::kable( Continents.non.na, booktabs = TRUE, caption = &#39;A table of the first 4 rows of our final project data.&#39; ) Table 4.1: A table of the first 4 rows of our final project data. Continents North America Unknown State # draw NA pattern # rownames(df) &lt;- df$`Place of Origin` states &lt;- df %&gt;% setNames(.,c(&quot;name&quot;,&quot;code&quot;, substring(colnames(.)[3:34], 1, 4),&quot;Continents&quot;)) tidydata &lt;- states[2:ncol(states)-1] %&gt;% rownames_to_column(&quot;id&quot;) %&gt;% gather(key, value, -id) %&gt;% mutate(missing = ifelse(is.na(value), &quot;yes&quot;, &quot;no&quot;)) missing &lt;- tidydata %&gt;% group_by(key) %&gt;% summarise(sum.na = sum(is.na(value))) ggplot(missing, aes(x = 2:ncol(states)-1, y = sum.na)) + geom_col(color = &quot;blue&quot;, fill = &quot;lightblue&quot;) + scale_x_continuous(breaks = 2:ncol(states)-1, labels = missing$key) + ggtitle(&quot;Number of missing values by years&quot;) + xlab(&quot;&quot;) + ylab(&quot;Number of total missing values&quot;) + theme(axis.text.x = element_text(angle = 90)) states2 &lt;- df %&gt;% setNames(.,c(&quot;name&quot;,&quot;code&quot;, substring(colnames(.)[3:34], 6, 7),&quot;Cont.&quot;)) %&gt;% select(&quot;name&quot;,&quot;code&quot;, &quot;50&quot;:&quot;95&quot;, &quot;Cont.&quot;) rownames(states2) &lt;- states2$name states.na &lt;- states2 %&gt;% filter(Cont. == &quot;Asia&quot;) result &lt;- rowSums(is.na(states.na)) %&gt;% sort(decreasing = TRUE) tidydata &lt;- states.na %&gt;% filter( name %in% names(result[result != 0]) ) %&gt;% rownames_to_column(&quot;id&quot;) %&gt;% gather(key, value, -id) %&gt;% mutate(missing = ifelse(is.na(value), &quot;yes&quot;, &quot;no&quot;)) ggplot(tidydata, aes(x = key, y = fct_rev(id), fill = missing)) + geom_tile(color = &quot;white&quot;) + ggtitle(&quot;Place has NA value in Asia&quot;) + ylab(&quot;Places&quot;) + xlab(&quot;columns&quot;) + scale_fill_viridis_d(option = &quot;inferno&quot;) + theme_bw() "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
